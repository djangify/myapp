{% extends "base.html" %}

{% block content %}
<div class="container max-w-5xl mx-auto px-4 mt-12 py-10">
      <div class="shop-cart-container">
    <h1 class="text-2xl md:text-3xl font-bold mt-12 mb-8">Shopping Cart</h1>
  
            {% if cart %}
            <div class="shop-cart">
                {% for item in cart %}
                <div class="shop-cart-item">
                    <!-- Image -->
                    <img src="{{ item.product.get_image_url }}" 
                        alt="{{ item.product.title }}" 
                        class="shop-cart-img">

                    <!-- Info -->
                    <div class="shop-cart-info">
                        <h3 class="text-lg font-semibold">{{ item.product.title }}</h3>
                        <p>Price: ${{ item.price|floatformat:2 }}</p>
                    </div>

                    <!-- Actions -->
                    <div class="shop-cart-actions">
                        <!-- Quantity Update -->
                        <form method="post" action="{% url 'shop:cart_update' item.product.id %}">
                            {% csrf_token %}
                            <input type="number" 
                                name="quantity" 
                                value="{{ item.quantity }}" 
                                min="1" max="99" 
                                class="shop-cart-qty">
                            <button type="submit" class="text-blue-600 hover:underline text-sm">Update</button>
                        </form>

                        <!-- Line Total -->
                        <span class="shop-cart-total">£{{ item.total_price|floatformat:2 }}</span>

                        <!-- Remove -->
                        <form method="post" action="{% url 'shop:cart_remove' item.product.id %}">
                            {% csrf_token %}
                            <button type="submit" class="shop-remove">Remove</button>
                        </form>
                    </div>
                </div>
                {% endfor %}

                <!-- Summary -->
                <div class="shop-cart-summary">
                    <p class="text-xl">Total Items: <strong>{{ cart|length }}</strong></p>
                    <p class="text-xl">Total: £{{ cart.get_total_price|floatformat:2 }}</p>
                    <div class="shop-cart-buttons">
                        <a href="{% url 'shop:product_list' %}" class="btn-secondary">
                            Continue Shopping
                        </a>
                        <a href="{% url 'shop:checkout' %}" class="btn-primary">
                            Proceed to Checkout
                        </a>
                    </div>
                </div>
            </div>

            {% else %}
            <!-- Empty Cart -->
            <div class="text-center py-12">
                <p>Your cart is empty.</p>
                <a href="{% url 'shop:product_list' %}" 
                class="mt-4 inline-block px-6 py-2 border border-gray-300 rounded">
                Continue Shopping
                </a>
            </div>
            {% endif %}
        </div>
    </div>
{% endblock %}
